<!DOCTYPE html>
<html>
<head>
  <title>TerraSphere Build Editor - Character Build</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/app.css">
  <link rel="stylesheet" href="css/index.css">
  <link rel="stylesheet" href="css/build-sheet.css">
  <link rel="shortcut icon" href="https://www.terrarp.com//favicon.ico">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  
  <!-- Shared modules -->
  <script src="shared/state-manager.js"></script>
  <script src="shared/dom-utils.js"></script>
  <script src="shared/data-loader.js"></script>
  <script src="shared/calculations.js"></script>
  <script src="shared/build-encoder.js"></script>
  <script src="shared/loading-manager.js"></script>
  
  <!-- Data files -->
  <script src="resource/masteries.js"></script>
  <script src="resource/expertise.js"></script>
  <script src="resource/actions.js"></script>
  <script src="resource/safecharacters.js"></script>
  <script src="resource/armor-abilities.js"></script>
  <script src="resource/card-templates.js"></script>
  <script src="resource/build-sheet.js"></script>
</head>

<body>
  <nav id="mw-navigation" class="fixed-top">
    <div class="container">
      <a href="https://terrarp.com/build/" class="navbar-brand">
        <img src="https://terrarp.com/db/logo/logo-xs.png">
      </a>
      <div class="nav-left">
        <div class="link"><a href="https://terrarp.com/build/index.html" style="color:#47cbdd">Build Planner</a></div>
        
        <div class="link"><a href="https://terrarp.com/index.php">Forums</a></div>
        <div class="link"><a href="https://terrarp.com/wiki/Main_Page">Wiki</a></div>
        <div class="dropdown">
          <button class="dropbtn">Important <i class="fa fa-caret-down"></i></button>
          <div class="dropdown-content">
            <a href="https://terrarp.com/wiki/Mastery">Mastery List</a>
            <a href="https://terrarp.com/wiki/Races">Playable Races</a>
            <a href="https://terrarp.com/wiki/RPG_Mechanics">RPG Mechanics</a>
            <a href="https://terrarp.com/wiki/Actions">Action List</a>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <div id="bodyback">
    <div id="builddisplay">
      <!-- Masteries Display -->
      <div class="banner">
        <div class="bannerstuff">
          <div class="bannercontent">
            <div class="charimg2 left">
              <div class="avatar-container">
                <img id="pfp2">
                <div class="rank-badge-avatar" id="rank-badge-avatar">E</div>
              </div>
            </div>
            <div class="charcontainer left">
            <span class="nameheader header-info--nameheader characterstuff">
              <span class="charname" id="character-name-display">Character Build</span>
              <span class="chartitle" id="character-title-display"></span>
<!--              <span class="charrace" id="character-race-display"></span>-->
            </span>
            </div>
            <div class="filler"></div>
            <div class="header-info--functions right">
              <div class="masterycategory" id="inputbox">
                <input type="text" id="threadcodereplace" autocomplete="off" placeholder="Thread code (510C5)...">
              </div>
              <div id="finalbuild"></div>
            </div>
          </div>
          <div class="filler"></div>
         <div class="bannerbottom">
             <div class="icons">
                 <div class="newgameplus">NG+</div>
             </div>
             <div class="filler"></div>
             <div class="masterycategory" id="statsdisplay">
                 <div class="hpdisplay"></div>
                 <div class="movementdisplay"></div>
                 <div class="rangedisplay"></div>
             </div>
        </div>
        </div>
      </div>

      <!-- Equipment and Saves Display -->
      <div class="equipment-saves-container">
        <div class="equipment-section">
          <h1 class="statheader">Equipment</h1>
          <div class="masterycategory mastery-margin" id="equipmentdisplay">
            <div class="weaponrankdisplay"></div>
            <div class="armorrankdisplay"></div>
            <div class="accessoryrankdisplay"></div>
          </div>
        </div>
        
        <div class="saves-section">
          <h1 class="statheader">Saves</h1>
          <div class="masterycategory mastery-margin" id="savesdisplay">
            <div class="fortitudesavedisplay"></div>
            <div class="reflexsavedisplay"></div>
            <div class="willsavedisplay"></div>
          </div>
        </div>
      </div>

      <!-- Mastery and Expertise Display -->
      <div class="mastery-expertise-container">
        <div class="mastery-section">
          <h1 class="statheader">Mastery</h1>
          <div class="masterycategory mastery-margin" id="masterydisplay"></div>
        </div>
        
        <div class="expertise-section">
          <h1 class="statheader">Expertise</h1>
          <div class="masterycategory mastery-margin" id="expertisedisplay"></div>
        </div>
      </div>


      <div class="masterycategory" id="equipmentpassive" style="margin-top:0">
        <div class="edisplay armorskilldisplay">
          <div class="passivecontainer">
            <span class='armorpassive'></span>
          </div>
        </div>
      </div>

      <!-- Saves and Checks -->
      <h3 class="selectorheader" id="savechecklabel">Saves and Checks
        <span class="ttip" data-tooltip="Click on the small icons at the bottom of the following cards to automatically apply the bonus and type name to the Discord roll code.">
          <span class="ttip-info"></span><i class="far fa-question-circle tip"></i>
        </span>
      </h3>
      <div class="masterycategory" id="saveschecks">
        <div class="card">
          <div class="cardtitle">Saves</div>
          <div class="rollcode clickable-rollcode" onclick="copyRollCode(this, event)" title="Click to copy">?r save <span class='saveadv'></span><span class='savebonusreplace'>X</span> <span class='reflexmodifiers'></span> # <span class='savereplace'>Type</span> · Character Name · <span class="thrcode">Thread Code</span></div>
          <div id="savesicons">
            <div class='display masterycircle aci-fortitude' onclick='clickFortitude(this)'>
              <img src='https://terrarp.com/db/tool/fortitude.png'>
            </div>
            <div class='display masterycircle aci-reflex' onclick='clickReflex(this)'>
              <img src='https://terrarp.com/db/tool/reflex.png'>
            </div>
            <div class='display masterycircle aci-will' onclick='clickWill(this)'>
              <img src='https://terrarp.com/db/tool/will.png'>
            </div>
          </div>
          <div class="togglecontainer">
            <div class="togglesavechecks" onclick="advantageSave(this)">Adv</div>
            <div class="togglesavechecks" onclick="normalSave(this)">Normal</div>
            <div class="togglesavechecks" onclick="disadvantageSave(this)">Dis</div>
          </div>
        </div>
        <div class="card">
          <div class="cardtitle">Expertise Check</div>
          <div class="rollcode clickable-rollcode" onclick="copyRollCode(this, event)" title="Click to copy">?r expertise <span class='expertiseadv'></span><span class='expertisebonusreplace'>ER</span> # <span class='expertisereplace'>Type</span> · Character Name · <span class="thrcode">Thread Code</span></div>
          <div id="expertiseicons">
            <!-- expertise icons will be populated by JavaScript based on selected expertise -->
          </div>
          <div class="togglecontainer">
            <div class="togglesavechecks" onclick="advantageExpertise(this)">Adv</div>
            <div class="togglesavechecks" onclick="normalExpertise(this)">Normal</div>
            <div class="togglesavechecks" onclick="disadvantageExpertise(this)">Dis</div>
          </div>
        </div>
        <div class="card">
          <div class="cardtitle">Mastery Check</div>
          <div class="rollcode clickable-rollcode" onclick="copyRollCode(this, event)" title="Click to copy">?r mastery <span class='masteryadv'></span><span class='masteryreplace'>MR</span> # <span class='mnamereplace'>Type</span> · <span class='breaktype'>Break-Type</span> · Character Name · <span class="thrcode">Thread Code</span></div>
          <div id="masterycheckicons"></div>
          <div class="togglecontainer">
            <div class="togglesavechecks" onclick="advantageMastery(this)">Adv</div>
            <div class="togglesavechecks" onclick="normalMastery(this)">Normal</div>
            <div class="togglesavechecks" onclick="disadvantageMastery(this)">Dis</div>
          </div>
        </div>
      </div>

      <!-- Actions Display -->
      <h3 class="selectorheader">
        Actions
        <div class="action-filters">
          <div class="filter-tab active" onclick="toggleActionFilter('all')" data-filter="all">All</div>
          <div class="filter-tab" onclick="toggleActionFilter('offense')" data-filter="offense">Offense</div>
          <div class="filter-tab" onclick="toggleActionFilter('defense')" data-filter="defense">Defense</div>
          <div class="filter-tab" onclick="toggleActionFilter('support')" data-filter="support">Support</div>
          <div class="filter-tab" onclick="toggleActionFilter('alter')" data-filter="alter">Alter</div>
        </div>
      </h3>
      <div class="masterycategory" id="freeactiondisplay">
        <!-- Free actions -->
        <div class="card normal attackfinal">
            <div class="cardtop">
                <div class="cardtopleft">
                    <div class="cardtitle">Attack</div>
                    <div class="filler"></div>
                    <p class="type">Basic</p>
                </div>
                <div class="filler"></div>
                <div class="cardicon" style="background-color: #1e2131; background-image: url('https://terrarp.com/db/action/attack.png'); background-repeat: no-repeat; background-position: center;"></div>
            </div>
          <div class="cardinfo">
            <p>Perform a basic attack.</p>
          </div>
          <div class="cardroll"><b>Roll:</b> 1d100 + MR + WR + other bonuses</div>
          <div class="rollcode clickable-rollcode" onclick="copyRollCode(this, event)" title="Click to copy">?r attack <span class='masteryreplace'>MR</span> WR <span class='damagepassivemod'></span># <span class='mnamereplace'>Mastery</span> · <span class='breaktype'>Break-Type</span> · Character Name · <span class='thrcode'>Code</span></div>
          <div class="risky-toggle-container"></div>
        </div>
        <div class="card rushfinal">
          <div class="cardinfo">
            <p><b>Bonus.</b> Gain 2 extra movements this cycle.</p>
          </div>
          <div class="rollcode rushrc clickable-rollcode" onclick="copyRollCode(this, event)" title="Click to copy">?r rush # Character Name · <span class="thrcode">Code</span></div>
        </div>
      </div>
      <div class="masterycategory" id="actionsdisplay"></div>

      <!-- Note -->
      <div class="masterycategory" id="notedisplay">
        <div class="note">
          <div class="share-options">
            <div class="share-option">
              <textarea id="note" placeholder="Enter any note here..."></textarea>
            </div>
          </div>
        </div>
      </div>

      <!-- Build Code Display -->
      <div class="masterycategory" id="buildcodedisplay">
        <div class="build-sharing">
          <div class="share-options">
            <div class="share-option">
              <label>Build URL:</label>
              <textarea id="build-url" readonly></textarea>
              <button class="copy-button" data-target="build-url">Copy</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="button-container">
      <div class="button" id="back-button">< Select Actions</div>
      <div class="button" id="edit-build-button">Edit This Build</div>
    </div>
  </div>


</body>
</html>